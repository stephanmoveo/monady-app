{"ast":null,"code":"var _jsxFileName = \"/Users/stephanbenchemoul/Documents/Projects/Moveo Skills Projects/monady-app/quickstart-react/src/components/video-js/VideoJS2.js\";\nimport React from \"react\";\nimport videojs from \"video.js\";\nimport \"video.js/dist/video-js.css\";\nimport \"./Video.css\";\nimport mondaySdk from \"monday-sdk-js\";\nimport AnnotationComments from \"@contently/videojs-annotation-comments\";\nimport \"@contently/videojs-annotation-comments/build/css/annotations.css\";\nvideojs.registerPlugin(\"annotationComments\", AnnotationComments(videojs));\nconst monday = mondaySdk();\n\nconst conifgurePlayer = () => {\n  let pluginOptions2 = { ...pluginOptions,\n    annotationsObjects: res.data.value === null ? [] : JSON.parse(res.data.value)\n  };\n  const videoElement = videoRef.current;\n  if (!videoElement) return;\n  const player = playerRef.current = videojs(videoElement, videoJsOptions, () => {\n    onReady && onReady(player);\n    configurePlugin(player, pluginOptions2, itemid, index);\n  });\n};\n\nconst configurePlugin = (player, pluginOptions2, itemid, index) => {\n  let plugin = player.annotationComments(pluginOptions2);\n  plugin.onReady(() => {});\n  plugin.registerListener(\"annotationDeleted\", event => {\n    plugin.fire('toggleAnnotationMode'); // toggle off\n\n    plugin.fire('toggleAnnotationMode'); // toggle on\n  });\n  plugin.registerListener(\"onStateChanged\", event => {\n    monday.storage.instance.setItem(itemid.toString() + \"k\" + index.toString(), JSON.stringify(event.detail)).then(res => {\n      console.log(res);\n    });\n  });\n};\n\nconst VideoJS2 = ({\n  src,\n  onReady,\n  index,\n  itemid,\n  userName\n}) => {\n  let pluginOptions = {\n    annotationsObjects: [],\n    meta: {\n      user_id: null,\n      user_name: userName\n    },\n    bindArrowKeys: true,\n    showControls: true,\n    showCommentList: true,\n    showFullScreen: true,\n    showMarkerShapeAndTooltips: true,\n    internalCommenting: true,\n    startInAnnotationMode: true\n  };\n  const videoJsOptions = {\n    autoplay: false,\n    controls: true,\n    responsive: true,\n    fluid: false,\n    loop: true,\n    sources: [{\n      src: src // type: ‘video/mp4’\n\n    }]\n  };\n  const videoRef = React.useRef(null);\n  const playerRef = React.useRef(null);\n  React.useEffect(() => {\n    monday.storage.instance.getItem(itemid.toString() + \"k\" + index.toString()).then(res => {\n      let pluginOptions2 = { ...pluginOptions,\n        annotationsObjects: res.data.value === null ? [] : JSON.parse(res.data.value)\n      };\n      const videoElement = videoRef.current;\n      if (!videoElement) return;\n      const player = playerRef.current = videojs(videoElement, videoJsOptions, () => {\n        onReady && onReady(player);\n        configurePlugin(player, pluginOptions2, itemid, index);\n      });\n    });\n  }, [videoJsOptions]);\n  React.useEffect(() => {\n    return () => {\n      if (playerRef.current) {\n        playerRef.current.dispose();\n        playerRef.current = null;\n      }\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    \"data-vjs-player\": true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"video\", {\n    ref: videoRef,\n    className: \"video-js vjs-big-play-centered\",\n    controls: true,\n    width: \"640\",\n    height: \"268\",\n    preload: \"auto\",\n    \"data-setup\": \"{ \\\"playbackRates\\\": [0.5, 1, 1.5, 2, 4] }\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default VideoJS2;","map":{"version":3,"sources":["/Users/stephanbenchemoul/Documents/Projects/Moveo Skills Projects/monady-app/quickstart-react/src/components/video-js/VideoJS2.js"],"names":["React","videojs","mondaySdk","AnnotationComments","registerPlugin","monday","conifgurePlayer","pluginOptions2","pluginOptions","annotationsObjects","res","data","value","JSON","parse","videoElement","videoRef","current","player","playerRef","videoJsOptions","onReady","configurePlugin","itemid","index","plugin","annotationComments","registerListener","event","fire","storage","instance","setItem","toString","stringify","detail","then","console","log","VideoJS2","src","userName","meta","user_id","user_name","bindArrowKeys","showControls","showCommentList","showFullScreen","showMarkerShapeAndTooltips","internalCommenting","startInAnnotationMode","autoplay","controls","responsive","fluid","loop","sources","useRef","useEffect","getItem","dispose"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport videojs from \"video.js\";\nimport \"video.js/dist/video-js.css\";\nimport \"./Video.css\";\nimport mondaySdk from \"monday-sdk-js\";\nimport AnnotationComments from \"@contently/videojs-annotation-comments\";\nimport \"@contently/videojs-annotation-comments/build/css/annotations.css\";\nvideojs.registerPlugin(\"annotationComments\", AnnotationComments(videojs));\nconst monday = mondaySdk();\n\n\nconst conifgurePlayer = ()=>{\n    let pluginOptions2 = {\n        ...pluginOptions,\n        annotationsObjects:\n          res.data.value === null ? [] : JSON.parse(res.data.value),\n      };\n      const videoElement = videoRef.current;\n      if (!videoElement) return;\n      const player = (playerRef.current = videojs(\n        videoElement,\n        videoJsOptions,\n        () => {\n          onReady && onReady(player);\n          configurePlugin(player,pluginOptions2,itemid ,index)\n        }\n      ));\n}\n\nconst configurePlugin = (player,pluginOptions2,itemid ,index) => {\n\n    let plugin = player.annotationComments(pluginOptions2);\n    plugin.onReady(() => {});\n    plugin.registerListener(\"annotationDeleted\", (event) => {        \n    plugin.fire('toggleAnnotationMode'); // toggle off\n    plugin.fire('toggleAnnotationMode'); // toggle on\n\n    });\n    plugin.registerListener(\"onStateChanged\", (event) => {\n      monday.storage.instance\n        .setItem(\n          itemid.toString() + \"k\" + index.toString(),\n          JSON.stringify(event.detail)\n        )\n        .then((res) => {\n          console.log(res);\n        });\n    });\n}\n\n\nconst VideoJS2 = ({ src, onReady, index, itemid, userName }) => {\n\n  let pluginOptions = {\n    annotationsObjects: [],\n    meta: { user_id: null, user_name: userName },\n    bindArrowKeys: true,\n    showControls: true,\n    showCommentList: true,\n    showFullScreen: true,\n    showMarkerShapeAndTooltips: true,\n    internalCommenting: true,\n    startInAnnotationMode: true,\n  };\n  const videoJsOptions = {\n    autoplay: false,\n    controls: true,\n    responsive: true,\n    fluid: false,\n    loop: true,\n    sources: [\n      {\n        src: src,\n        // type: ‘video/mp4’\n      },\n    ],\n  };\n  const videoRef = React.useRef(null);\n  const playerRef = React.useRef(null);\n  React.useEffect(() => {\n    monday.storage.instance\n      .getItem(itemid.toString() + \"k\" + index.toString())\n      .then((res) => {\n        let pluginOptions2 = {\n          ...pluginOptions,\n          annotationsObjects:\n            res.data.value === null ? [] : JSON.parse(res.data.value),\n        };\n        const videoElement = videoRef.current;\n        if (!videoElement) return;\n        const player = (playerRef.current = videojs(\n          videoElement,\n          videoJsOptions,\n          () => {\n            onReady && onReady(player);\n            configurePlugin(player,pluginOptions2,itemid ,index)\n          }\n        ));\n      });\n  }, [videoJsOptions]);\n\n\n\n  React.useEffect(() => {\n    return () => {\n      if (playerRef.current) {\n        playerRef.current.dispose();\n        playerRef.current = null;\n      }\n    };\n  }, []);\n  return (\n    <div data-vjs-player>\n      <video\n        ref={videoRef}\n        className=\"video-js vjs-big-play-centered\"\n        controls\n        width=\"640\"\n        height=\"268\"\n        preload=\"auto\"\n        data-setup='{ \"playbackRates\": [0.5, 1, 1.5, 2, 4] }'\n      />\n    </div>\n  );\n};\nexport default VideoJS2;\n"]},"metadata":{},"sourceType":"module"}